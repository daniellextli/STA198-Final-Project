---
title: "Final Project"
subtitle: "Due Wednesday, December 3, 11:59 PM"
authors: "Danielle, Beckett, and Alexia"
format: pdf
---

## Use of AI tools

I did not use AI in the completion of this assignment.

## Loading Libraries/Dataset
```{r}
#| message: false
#| warning: false
#| echo: false
library(tidyverse)
library(ggplot2)
library(dplyr)

data <- read_csv("coffee_data.csv") |>
  filter(!is.na(Stress_Level), !is.na(Caffeine_mg)) |> 
  mutate(high_caffeine = factor(ifelse(Caffeine_mg > 400, 1, 0)))
data_clean <- data[complete.cases(data$Stress_Level, data$Caffeine_mg), ] 

```

## Visualizations of Patients' Demographic
```{r}
# m <- lm(Sleep_Hours ~ ., data = data)

# Distribution of participants by country
ggplot(data, aes(x = Country)) +
  geom_bar(color = "darkgrey", fill = "lightblue") +
  labs(
    x = "Country",
    y = "Number of Participants",
    title = "Distribution of Participants by Country"
  ) +
  theme_bw() +
    theme(axis.text.x = element_text(angle = 45, hjust = 1))

# gender distribution
ggplot(data, aes(x = Gender)) +
  geom_bar(fill = "lightcoral", color = "black") +
  labs(title = "Gender Distribution", y = "Count", x = "Gender") +
  theme_bw()

# age distribution
ggplot(data, aes(x = Age)) +
  geom_histogram(binwidth = 5, fill = "lightblue", color = "black") +
  labs(title = "Age Distribution of Participants", x = "Age (years)", y = "Count") +
  theme_bw()

```
## Visualizations of Coffee Consumption
```{r}
# Coffee Intake Distribution
ggplot(data, aes(x = Coffee_Intake)) +
  geom_histogram(binwidth = 0.5, fill = "lightsteelblue1", color = "black") +
  labs(title = "Distribution of Daily Coffee Intake", x = "Cups per Day", y = "Count") +
  theme_bw()

```

## Models
```{r}
#BMI, Heart rate, sleep quality, and stress levels
m2 <- glm(high_caffeine ~ BMI + factor(Sleep_Quality) + Heart_Rate + factor(Stress_Level), 
          data = data,
          family = "binomial")
summary(m2)

table(data$Stress_Level, data$high_caffeine)
```